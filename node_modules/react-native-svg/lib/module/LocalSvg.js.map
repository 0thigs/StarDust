{"version":3,"names":["NativeModules","RNSVGRenderableManager","getRawResource","getUriFromSource","source","resolvedAssetSource","Image","resolveAssetSource","uri","loadLocalRawResourceDefault","fetchText","isUriAnAndroidResourceIdentifier","indexOf","loadAndroidRawResource","console","error","loadLocalRawResourceAndroid","loadLocalRawResource","Platform","OS","LocalSvg","props","asset","rest","useState","xml","setXml","useEffect","then","WithLocalSvg","load","prevProps","setState","state","Component"],"sources":["LocalSvg.tsx"],"sourcesContent":["import React, { useState, useEffect, Component } from 'react';\nimport {\n  NativeModules,\n  Platform,\n  Image,\n  ImageSourcePropType,\n} from 'react-native';\n\nimport { fetchText } from './xml';\nimport { SvgCss, SvgWithCss } from './css';\nimport { SvgProps } from './elements/Svg';\n\nconst { getRawResource } = NativeModules.RNSVGRenderableManager || {};\n\nexport function getUriFromSource(source: ImageSourcePropType) {\n  const resolvedAssetSource = Image.resolveAssetSource(source);\n  return resolvedAssetSource.uri;\n}\n\nexport function loadLocalRawResourceDefault(source: ImageSourcePropType) {\n  const uri = getUriFromSource(source);\n  return fetchText(uri);\n}\n\nexport function isUriAnAndroidResourceIdentifier(uri?: string) {\n  return typeof uri === 'string' && uri.indexOf('/') <= -1;\n}\n\nexport async function loadAndroidRawResource(uri: string) {\n  try {\n    return await getRawResource(uri);\n  } catch (e) {\n    console.error(\n      'Error in RawResourceUtils while trying to natively load an Android raw resource: ',\n      e,\n    );\n    return null;\n  }\n}\n\nexport function loadLocalRawResourceAndroid(source: ImageSourcePropType) {\n  const uri = getUriFromSource(source);\n  if (isUriAnAndroidResourceIdentifier(uri)) {\n    return loadAndroidRawResource(uri);\n  } else {\n    return fetchText(uri);\n  }\n}\n\nexport const loadLocalRawResource =\n  Platform.OS !== 'android'\n    ? loadLocalRawResourceDefault\n    : loadLocalRawResourceAndroid;\n\nexport type LocalProps = SvgProps & {\n  asset: ImageSourcePropType;\n  override?: Object;\n};\nexport type LocalState = { xml: string | null };\n\nexport function LocalSvg(props: LocalProps) {\n  const { asset, ...rest } = props;\n  const [xml, setXml] = useState(null);\n  useEffect(() => {\n    loadLocalRawResource(asset).then(setXml);\n  }, [asset]);\n  return <SvgCss xml={xml} {...rest} />;\n}\n\nexport class WithLocalSvg extends Component<LocalProps, LocalState> {\n  state = { xml: null };\n  componentDidMount() {\n    this.load(this.props.asset);\n  }\n  componentDidUpdate(prevProps: { asset: ImageSourcePropType }) {\n    const { asset } = this.props;\n    if (asset !== prevProps.asset) {\n      this.load(asset);\n    }\n  }\n  async load(asset: ImageSourcePropType) {\n    try {\n      this.setState({ xml: asset ? await loadLocalRawResource(asset) : null });\n    } catch (e) {\n      console.error(e);\n    }\n  }\n  render() {\n    const {\n      props,\n      state: { xml },\n    } = this;\n    return <SvgWithCss xml={xml} override={props} />;\n  }\n}\n\nexport default LocalSvg;\n"],"mappings":"+iDAAA,qDACA,yCAOA,0BACA,0B,k0DAGA,SAA2BA,0BAAA,CAAcC,sBAAd,EAAwC,EAAnE,CAAQC,cAAR,MAAQA,cAAR,CAEO,QAASC,iBAAT,CAA0BC,MAA1B,CAAuD,CAC5D,GAAMC,oBAAmB,CAAGC,kBAAA,CAAMC,kBAAN,CAAyBH,MAAzB,CAA5B,CACA,MAAOC,oBAAmB,CAACG,GAA3B,CACD,CAEM,QAASC,4BAAT,CAAqCL,MAArC,CAAkE,CACvE,GAAMI,IAAG,CAAGL,gBAAgB,CAACC,MAAD,CAA5B,CACA,MAAO,GAAAM,cAAA,EAAUF,GAAV,CAAP,CACD,CAEM,QAASG,iCAAT,CAA0CH,GAA1C,CAAwD,CAC7D,MAAO,OAAOA,IAAP,GAAe,QAAf,EAA2BA,GAAG,CAACI,OAAJ,CAAY,GAAZ,GAAoB,CAAC,CAAvD,CACD,CAEM,QAAeC,uBAAf,CAAsCL,GAAtC,qMAEUN,cAAc,CAACM,GAAD,CAFxB,gHAIHM,OAAO,CAACC,KAAR,CACE,mFADF,cAJG,gCAQI,IARJ,2EAYA,QAASC,4BAAT,CAAqCZ,MAArC,CAAkE,CACvE,GAAMI,IAAG,CAAGL,gBAAgB,CAACC,MAAD,CAA5B,CACA,GAAIO,gCAAgC,CAACH,GAAD,CAApC,CAA2C,CACzC,MAAOK,uBAAsB,CAACL,GAAD,CAA7B,CACD,CAFD,IAEO,CACL,MAAO,GAAAE,cAAA,EAAUF,GAAV,CAAP,CACD,CACF,CAEM,GAAMS,qBAAoB,CAC/BC,qBAAA,CAASC,EAAT,GAAgB,SAAhB,CACIV,2BADJ,CAEIO,2BAHC,C,kDAWA,QAASI,SAAT,CAAkBC,KAAlB,CAAqC,CAC1C,GAAQC,MAAR,CAA2BD,KAA3B,CAAQC,KAAR,CAAkBC,IAAlB,uCAA2BF,KAA3B,YACA,cAAsB,GAAAG,eAAA,EAAS,IAAT,CAAtB,qDAAOC,GAAP,eAAYC,MAAZ,eACA,GAAAC,gBAAA,EAAU,UAAM,CACdV,oBAAoB,CAACK,KAAD,CAApB,CAA4BM,IAA5B,CAAiCF,MAAjC,EACD,CAFD,CAEG,CAACJ,KAAD,CAFH,EAGA,MAAO,8BAAC,WAAD,wBAAQ,GAAG,CAAEG,GAAb,EAAsBF,IAAtB,+EAAP,CACD,C,GAEYM,a,0aACH,CAAEJ,GAAG,CAAE,IAAP,C,uFACR,4BAAoB,CAClB,KAAKK,IAAL,CAAU,KAAKT,KAAL,CAAWC,KAArB,EACD,C,kCACD,4BAAmBS,SAAnB,CAA8D,CAC5D,GAAQT,MAAR,CAAkB,KAAKD,KAAvB,CAAQC,KAAR,CACA,GAAIA,KAAK,GAAKS,SAAS,CAACT,KAAxB,CAA+B,CAC7B,KAAKQ,IAAL,CAAUR,KAAV,EACD,CACF,C,oBACD,cAAWA,KAAX,kJAEI,IAFJ,KAEyBA,KAFzB,6EAEuCL,oBAAoB,CAACK,KAAD,CAF3D,gFAEqE,IAFrE,gDAEoBG,GAFpB,4BAESO,QAFT,sHAIIlB,OAAO,CAACC,KAAR,eAJJ,2E,sBAOA,iBAAS,CACP,GACEM,MADF,CAGI,IAHJ,CACEA,KADF,CAEWI,GAFX,CAGI,IAHJ,CAEEQ,KAFF,CAEWR,GAFX,CAIA,MAAO,8BAAC,eAAD,EAAY,GAAG,CAAEA,GAAjB,CAAsB,QAAQ,CAAEJ,KAAhC,6EAAP,CACD,C,0BAxB+Ba,gB,iDA2BnBd,Q"}