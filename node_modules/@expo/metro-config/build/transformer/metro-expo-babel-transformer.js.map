{"version":3,"file":"metro-expo-babel-transformer.js","names":["transformer","resolveTransformer","projectRoot","resolvedPath","resolveFrom","silent","Error","require","transform","props","options","extendsBabelConfigPath","module","exports","getCacheKey"],"sources":["../../src/transformer/metro-expo-babel-transformer.ts"],"sourcesContent":["// Copyright 2021-present 650 Industries (Expo). All rights reserved.\n\nimport resolveFrom from 'resolve-from';\n\nimport { getCacheKey } from './getCacheKey';\n\nlet transformer: any = null;\n\nfunction resolveTransformer(projectRoot: string) {\n  if (transformer) {\n    return transformer;\n  }\n  const resolvedPath = resolveFrom.silent(projectRoot, 'metro-react-native-babel-transformer');\n  if (!resolvedPath) {\n    throw new Error(\n      'Missing package \"metro-react-native-babel-transformer\" in the project. ' +\n        'This usually means `react-native` is not installed. ' +\n        'Please verify that dependencies in package.json include \"react-native\" ' +\n        'and run `yarn` or `npm install`.'\n    );\n  }\n  transformer = require(resolvedPath);\n  return transformer;\n}\n\n/**\n * Extends the default `metro-react-native-babel-transformer`\n * and uses babel-preset-expo as the default instead of metro-react-native-babel-preset.\n * This enables users to safely transpile an Expo project without\n * needing to explicitly define a `babel.config.js`\n *\n * @param filename string\n * @param options BabelTransformerOptions\n * @param plugins $PropertyType<BabelCoreOptions, 'plugins'>\n * @param src string\n *\n * @returns\n */\nfunction transform(props: {\n  filename: string;\n  options: Record<string, any> & { projectRoot: string };\n  plugins?: unknown;\n  src: string;\n}) {\n  // Use babel-preset-expo by default if available...\n  props.options.extendsBabelConfigPath = resolveFrom.silent(\n    props.options.projectRoot,\n    'babel-preset-expo'\n  );\n  return resolveTransformer(props.options.projectRoot).transform(props);\n}\n\nmodule.exports = {\n  getCacheKey,\n  transform,\n};\n"],"mappings":";;AAEA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AAEA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;;;AAJA;AAMA,IAAIA,WAAgB,GAAG,IAAvB;;AAEA,SAASC,kBAAT,CAA4BC,WAA5B,EAAiD;EAC/C,IAAIF,WAAJ,EAAiB;IACf,OAAOA,WAAP;EACD;;EACD,MAAMG,YAAY,GAAGC,sBAAA,CAAYC,MAAZ,CAAmBH,WAAnB,EAAgC,sCAAhC,CAArB;;EACA,IAAI,CAACC,YAAL,EAAmB;IACjB,MAAM,IAAIG,KAAJ,CACJ,4EACE,sDADF,GAEE,yEAFF,GAGE,kCAJE,CAAN;EAMD;;EACDN,WAAW,GAAGO,OAAO,CAACJ,YAAD,CAArB;EACA,OAAOH,WAAP;AACD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASQ,SAAT,CAAmBC,KAAnB,EAKG;EACD;EACAA,KAAK,CAACC,OAAN,CAAcC,sBAAd,GAAuCP,sBAAA,CAAYC,MAAZ,CACrCI,KAAK,CAACC,OAAN,CAAcR,WADuB,EAErC,mBAFqC,CAAvC;EAIA,OAAOD,kBAAkB,CAACQ,KAAK,CAACC,OAAN,CAAcR,WAAf,CAAlB,CAA8CM,SAA9C,CAAwDC,KAAxD,CAAP;AACD;;AAEDG,MAAM,CAACC,OAAP,GAAiB;EACfC,WAAW,EAAXA,0BADe;EAEfN;AAFe,CAAjB"}