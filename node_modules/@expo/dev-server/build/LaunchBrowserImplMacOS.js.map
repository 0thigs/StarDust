{"version":3,"file":"LaunchBrowserImplMacOS.js","names":["LaunchBrowserImplMacOS","LaunchBrowserTypes","CHROME","EDGE","isSupportedBrowser","browserType","result","osascript","execAsync","MAP","createTempBrowserDir","baseDirName","path","join","require","launchAsync","args","appDirectory","appPath","globSync","cwd","trim","absolute","Error","_process","spawn","stdio","close","kill","undefined"],"sources":["../src/LaunchBrowserImplMacOS.ts"],"sourcesContent":["import * as osascript from '@expo/osascript';\nimport { spawn, type ChildProcess } from 'child_process';\nimport { sync as globSync } from 'glob';\nimport path from 'path';\n\nimport {\n  LaunchBrowserTypes,\n  type LaunchBrowserImpl,\n  type LaunchBrowserInstance,\n} from './LaunchBrowser.types';\n\n/**\n * Browser implementation for macOS\n */\nexport default class LaunchBrowserImplMacOS implements LaunchBrowserImpl, LaunchBrowserInstance {\n  private _process: ChildProcess | undefined;\n\n  MAP = {\n    [LaunchBrowserTypes.CHROME]: 'google chrome',\n    [LaunchBrowserTypes.EDGE]: 'microsoft edge',\n  };\n\n  async isSupportedBrowser(browserType: LaunchBrowserTypes): Promise<boolean> {\n    let result = false;\n    try {\n      await osascript.execAsync(`id of application \"${this.MAP[browserType]}\"`);\n      result = true;\n    } catch {\n      result = false;\n    }\n    return result;\n  }\n\n  async createTempBrowserDir(baseDirName: string) {\n    return path.join(require('temp-dir'), baseDirName);\n  }\n\n  async launchAsync(\n    browserType: LaunchBrowserTypes,\n    args: string[]\n  ): Promise<LaunchBrowserInstance> {\n    const appDirectory = await osascript.execAsync(\n      `POSIX path of (path to application \"${this.MAP[browserType]}\")`\n    );\n    const appPath = globSync('Contents/MacOS/*', { cwd: appDirectory.trim(), absolute: true })?.[0];\n    if (!appPath) {\n      throw new Error(`Cannot find application path from ${appDirectory}Contents/MacOS`);\n    }\n    this._process = spawn(appPath, args, { stdio: 'ignore' });\n\n    return this;\n  }\n\n  async close(): Promise<void> {\n    this._process?.kill();\n    this._process = undefined;\n  }\n}\n"],"mappings":";;;;;;;AAAA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AACA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;AAEA;EAAA;;EAAA;IAAA;EAAA;;EAAA;AAAA;;;;;;;;;;AAMA;AACA;AACA;AACe,MAAMA,sBAAN,CAAiF;EAAA;IAAA;;IAAA,6BAGxF;MACJ,CAACC,mCAAA,CAAmBC,MAApB,GAA6B,eADzB;MAEJ,CAACD,mCAAA,CAAmBE,IAApB,GAA2B;IAFvB,CAHwF;EAAA;;EAQtE,MAAlBC,kBAAkB,CAACC,WAAD,EAAoD;IAC1E,IAAIC,MAAM,GAAG,KAAb;;IACA,IAAI;MACF,MAAMC,SAAS,GAACC,SAAV,CAAqB,sBAAqB,KAAKC,GAAL,CAASJ,WAAT,CAAsB,GAAhE,CAAN;MACAC,MAAM,GAAG,IAAT;IACD,CAHD,CAGE,MAAM;MACNA,MAAM,GAAG,KAAT;IACD;;IACD,OAAOA,MAAP;EACD;;EAEyB,MAApBI,oBAAoB,CAACC,WAAD,EAAsB;IAC9C,OAAOC,eAAA,CAAKC,IAAL,CAAUC,OAAO,CAAC,UAAD,CAAjB,EAA+BH,WAA/B,CAAP;EACD;;EAEgB,MAAXI,WAAW,CACfV,WADe,EAEfW,IAFe,EAGiB;IAAA;;IAChC,MAAMC,YAAY,GAAG,MAAMV,SAAS,GAACC,SAAV,CACxB,uCAAsC,KAAKC,GAAL,CAASJ,WAAT,CAAsB,IADpC,CAA3B;IAGA,MAAMa,OAAO,gBAAG,IAAAC,YAAA,EAAS,kBAAT,EAA6B;MAAEC,GAAG,EAAEH,YAAY,CAACI,IAAb,EAAP;MAA4BC,QAAQ,EAAE;IAAtC,CAA7B,CAAH,8CAAG,UAA6E,CAA7E,CAAhB;;IACA,IAAI,CAACJ,OAAL,EAAc;MACZ,MAAM,IAAIK,KAAJ,CAAW,qCAAoCN,YAAa,gBAA5D,CAAN;IACD;;IACD,KAAKO,QAAL,GAAgB,IAAAC,sBAAA,EAAMP,OAAN,EAAeF,IAAf,EAAqB;MAAEU,KAAK,EAAE;IAAT,CAArB,CAAhB;IAEA,OAAO,IAAP;EACD;;EAEU,MAALC,KAAK,GAAkB;IAAA;;IAC3B,uBAAKH,QAAL,kEAAeI,IAAf;IACA,KAAKJ,QAAL,GAAgBK,SAAhB;EACD;;AA1C6F"}